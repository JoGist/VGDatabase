!!!
%html{:lang => "en", class: "container"}
  %head
    %title Search result - VGDatabase
  %body.visible
    %aside.sidebar.normal
      %nav
        %ul.sidebar__nav 
          %li
            %a.sidebar__nav__link_plain_img
              =image_tag ('logo-normal.png')
          %li
            %a.sidebar__nav__link{:href => homepage_path, "data-method" => "get"}
              %i.mdi.mdi-home
              %span.sidebar__nav__text Homepage
          %li
            %a.sidebar__nav__link{:href => myLibrary_path, "data-method" => "get"}
              %i.mdi.mdi-library-movie
              %span.sidebar__nav__text My library
          %li
            %a.sidebar__nav__link{:href => myLibraryFavorites_path, "data-method" => "get"}
              %i.mdi.mdi-star
              %span.sidebar__nav__text  Favorites
          %li.active
            %a.sidebar__nav__link{:href => searchGame_path, "data-method" => "get"}
              %i.mdi.mdi-database-search
              %span.sidebar__nav__text Search
          %li
            %a.sidebar__nav__link{:href => friends_path, "data-method" => "get"}
              %i.mdi.mdi-account-multiple
              %span.sidebar__nav__text Friends
          %li
            %a.sidebar__nav__link{:href => myProfile_path, "data-method" => "get"}
              =image_tag (@user.avatar), class: "img3"
              %span.sidebar__nav__text My account
          %li
            %a.sidebar__nav__link{:href => login_path, "data-method" => "delete"}
              %i.mdi.mdi-logout-variant
              %span.sidebar__nav__text Log out 
          %li
            %a.sidebar__nav__link{:href => contactUs_path, "data-method" => "get"}
              %i.mdi.mdi-information
              %span.sidebar__nav__text Contact us
    %br/
    %h1 Search result
    %div.page-content
      - @games.each do |game|
        -if game.keys.include?('cover') && game.keys.include?('genres') && game.keys.include?('platforms')
          -api_endpoint = 'https://api-v3.igdb.com/covers'
          -request_headers = { headers: { 'user-key' => Rails.application.credentials.maps[:igdb] } }
          -api = Apicalypse.new(api_endpoint, request_headers)
          -@cover = api.fields(:url).where(:id => game.values[1] ).request[0].values[1]

          -api_endpoint = 'https://api-v3.igdb.com/genres'
          -request_headers = { headers: { 'user-key' => Rails.application.credentials.maps[:igdb] } }
          -api = Apicalypse.new(api_endpoint, request_headers)
          -@genres = api.fields(:name).where(:id => game.values[2][0] ).request[0].values[1]

          -api_endpoint = 'https://api-v3.igdb.com/platforms'
          -request_headers = { headers: { 'user-key' => Rails.application.credentials.maps[:igdb] } }
          -api = Apicalypse.new(api_endpoint, request_headers)
          -@platform = api.fields(:name).where(:id => game.values[4][0] ).request[0].values[1]

          .card
            .content.cardPadding
              %p.description Genre: #{@genres}
              %p.description Platforms: #{@platform}
            %img.cover{:alt => "Game image cover", :src => "#{@cover}"}
        -else
          .card
            .content.cardPadding
            %img.cover{:alt => "Game image cover", :src => "https://cdn.eso.org/images/thumb300y/eso1907a.jpg"}

        
